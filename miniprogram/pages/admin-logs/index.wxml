<!--pages/admin-logs/index.wxml-->
<view class="container pb-20">
  <van-search
    value="{{ searchVal }}"
    placeholder="搜索操作人 / 物料名称"
    bind:search="onSearch"
    bind:change="onSearchChange"
    bind:clear="onClear"
    background="#f7f8fa"
  />

  <view class="p-15">
    <block wx:for="{{ list }}" wx:key="_id">
      <view class="log-card">
        <view class="flex-row justify-between mb-10">
          <view class="flex-row items-center">
            <van-tag type="{{ item.typeColor }}" custom-class="mr-10">{{ item.typeText }}</van-tag>
            <text class="font-bold text-md">{{ item.material_name }}</text>
          </view>
          <text class="text-xs text-secondary">{{ item.timeStr }}</text>
        </view>

        <view class="text-sm text-dark mb-5">
           {{ item.description || '无描述' }}
        </view>

        <view class="flex-row justify-between items-center mt-10 border-top pt-10">
           <text class="text-xs text-secondary">操作人: {{ item.operator }}</text>
           <text class="text-sm font-bold {{ item.quantity_change > 0 ? 'text-success' : (item.quantity_change < 0 ? 'text-danger' : 'text-secondary') }}">
              {{ item.quantity_change > 0 ? '+' : '' }}{{ item.quantity_change }}
           </text>
        </view>
      </view>
    </block>

    <van-empty wx:if="{{ !loading && list.length === 0 }}" description="暂无记录" />

    <view wx:if="{{ loading }}" class="text-center p-20">
      <van-loading size="24px">加载中...</van-loading>
    </view>

    <view wx:if="{{ isEnd && list.length > 0 }}" class="text-center text-secondary text-sm p-10">
      - 已无更多 -
    </view>
  </view>
</view>
